apiVersion: v1
kind: Pod
metadata:
  labels:
    app: jenkins-agent
spec:
  nodeSelector:
    beta.kubernetes.io/os: linux
  activeDeadlineSeconds: 10800

  volumes:
    - name: scripts
      emptyDir: {}

  imagePullSecrets:
    - name: gcp-art-registry-credentials

  initContainers:
    - name: init-container
      image: busybox:1.34
      command: ["/bin/sh", "-c"]
      args: ["cp -r /tmp/scripts /mnt/fabric-jar-exec"]
      imagePullPolicy: IfNotPresent
      volumeMounts:
        - name: scripts
          mountPath: /mnt/fabric-jar-exec
      resources:
        limits:
          memory: 100Mi
        requests:
          memory: 100Mi

  containers:
    - name: main-container
      image: openjdk:17-alpine
      command: ["/bin/sh", "-c"]
      args: ["sleep 3600"]
      imagePullPolicy: IfNotPresent
      volumeMounts:
        - name: scripts
          mountPath: /mnt/fabric-jar-exec
